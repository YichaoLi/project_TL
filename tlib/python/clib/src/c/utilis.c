//==================================================================================================
// Author Jens Chluba May 2010
//==================================================================================================
#include <string.h>
#include <math.h>
#include "stdio.h"

#include "utilis.h"

//using namespace std;


//==================================================================================================
// simple stuff
//==================================================================================================
int imin(int i, int j){ return (i<=j ? i : j); }
int imax(int i, int j){ return (i>=j ? i : j); }

double signum(double x){ return x>=0 ? 1 : -1; }
double onetothek(int k){ return k%2 ? -1 :  1; }


//==================================================================================================
// Factorials n! and Double factorial n!!
//==================================================================================================
double dfactorial(double dn)
{ if(dn<=1.0) return 1.0; return dn*dfactorial(dn-1.0); }

double factorial(int n)
{ 
	if(n>=20) return sqrt(TWOPI*(n+1.0))*exp(-(n+1.0))*pow(n+1.0, n)*
		(1.0+8.333333333333e-2/(n+1.0)
		 +3.472222222222e-3/(n+1.0)/(n+1.0)
		 -2.681327160494e-3/(n+1.0)/(n+1.0)/(n+1.0)
		 -2.294720936214e-4/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)
		 +7.840392217201e-4/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)
		 +6.972813758366e-5/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)
		 -5.921664373537e-4/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0) 
		 );
	
	return dfactorial( (double) n); 
}

double dlog10factorial(double dn)
{ if(dn<=1.0) return 0.0; return log10(dn)+dlog10factorial(dn-1.0); }

double log10factorial(int n)
{ 
	if(n>=20) return 0.5*log10(TWOPI*(n+1.0))+n*log10(n+1.0)-(n+1.0)*0.43429448190325176
		+log10(
			   1.0+8.333333333333e-2/(n+1.0)
			   +3.472222222222e-3/(n+1.0)/(n+1.0)
			   -2.681327160494e-3/(n+1.0)/(n+1.0)/(n+1.0)
			   -2.294720936214e-4/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)
			   +7.840392217201e-4/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)
			   +6.972813758366e-5/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)
			   -5.921664373537e-4/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0)/(n+1.0) 
			   );
	
	return dlog10factorial( (double) n); 
}

//==================================================================================================
// Double factorial n!!
//==================================================================================================
double log10doublefactorial(int n)
{
	if(n<=1) return log10(1.0);

	// here the useful relation is (2m-1)!!=(2m)! / m! / 2^m
	int m;
	//
	if ( n % 2 == 0 ) m=n/2;
	else m=(n+1)/2;
		
	return log10factorial(2*m) - log10factorial(m) - m*log10(2.0);
}

double doublefactorial(int n)
{ return pow(10.0, log10doublefactorial(n)); }


//==================================================================================================
// i/o modules
//==================================================================================================
/*
string int_to_string(int i)
{
    if(i==0) return "0";
    
    char   buf[16];
    int dig=10, num=0;
    string name="";
    
    if(i<0)
    {
        name="-";
        i=-i;
    }
    
    while(i>=dig) dig*=10;
    
    while(dig!=1)
    {
        dig/=10;
        num = (int)(i/dig);
        sprintf(buf, "%d", num); 
        name += *buf;
        i-=num*dig;
    }
    
    return name;
}

string int_to_string(int i, int ni)
{
    string name=int_to_string(i);
    int len=name.length();
    
    for(int l=len; l<ni; l++) name="0"+name;
    
    return name;
}
*/
//==================================================================================================
//==================================================================================================

